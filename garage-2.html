
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd" />
<html>
<head>
<meta http-equiv="Content-Type" content="text/html" charset="UTF-8"/>
<meta name="viewport" content="height = device-height, width = device-width, user-scalable = no"/>
<title> FETCH </title>

<!-- This code adds app icons -->
<!-- ANDROID -->
<link rel="icon" href="/appicon.png">
<meta name="mobile-web-app-capable" content="yes">
<!-- APPLE -->
<link rel="apple-touch-startup-image" href="/appicon.png">
<link rel="apple-touch-icon" href="/appicon.png">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black" />
<!-- ..END APP ICONS.. -->

<script type="text/javascript" src="/webiopi.js">
  </script>

<script type="text/javascript">
  webiopi().ready(function() {
    var content, sensor1btn, button;
  
  webiopi().setFunction(7,"in");   // GPIO 7 = Door Relay1
  webiopi().setFunction(17,"out"); // GPIO17 = Light1
  webiopi().setFunction(18,"in");  // GPIO18 = Door Sensor1
  
  // create a 'null' button for sensor1
  sensor1btn = $("#sensor1"); $(checkStatus);
  button = webiopi().createGPIOButton(18, "");
  sensor1btn.append(button); // append button to content div

  // create door button that calls the showConfirm function
  content  = $("#content");
  button = webiopi().createButton("button", "FOR YOUR THOUGHTS", showConfirm );
  content.append(button); // append button to content div
  
  // checks status of door sensor1
  function checkStatus() {
    if ( $('#gpio18').hasClass('LOW') )
        { $("#gpio18").html('PUPSTER'); } // sensor1 text when closed
    else { $("#gpio18").html('LUCKY'); }  // sensor1 text when open
    setTimeout(checkStatus,1000)          // wait one second, then restart checkStatus
  }

  // sets relay1 to 'OUT' which will trip relay.  After .5 second, call ButtonRls.
  // changes to action image. After 12 seconds, call ImgNormal.
  function ButtonPrsd() {
    webiopi().setFunction(7,"out");
    setTimeout(ButtonRls, 500);
    ImgAction();
    setTimeout(ImgNormal, 12000);
  } // ButtonPrsd
  
  // sets relay1 back to 'IN'
  function ButtonRls() {
    webiopi().setFunction(7,"in");
    hideConfirm();
  } // ButtonRls
  
  // hide the confirmation box div
  function hideConfirm() {
    document.getElementById('confirmBox').style.visibility = "hidden";
    document.getElementById('confirmText').style.visibility = "hidden";
  } // hideConfirm
  
  // show confirmation div after pressing garage door button
  function showConfirm() {
    document.getElementById('confirmBox').style.visibility = "visible";
    document.getElementById('confirmText').style.visibility = "visible";
    document.getElementById('yes').onclick = ButtonPrsd;
    document.getElementById('no').onclick = hideConfirm;
  } // showConfirm

  // change action-image to normal
  function ImgAction() {
    document.getElementById('button').style.background = "#808080 url('/door-action.gif') no-repeat center top";
  } // ImgAction
  
  // change action-image to normal
  function ImgNormal() {
    document.getElementById('button').style.background = "#808080 url('/door-static.png') no-repeat center bottom";
  } // ImgNormal
  
  // constantly refresh status to see if door(s) have changed state
  webiopi().refreshGPIO(true)
  
  }  // end first function call
  
  ); // end ready action
  </script>
    
    
 <style type="text/css">
  
  body {
   font-family: Arial, Helvetica, Sans-Serif;
   padding: 0px;
   margin: 0px;
   background: #CCCCCC;
  }
  
  h2 {
   text-align: center;
   margin-top: 0px !important;
   margin-bottom: 10px !important;
  }
  
  #header {
    margin-left: auto;
    margin-right: auto;
    margin-top: 0px !important;
    padding-top: 0px !important;
  }
                
  #content {
    width: 300px;
    height: 250px;
  }
  
  button {
    display: block;
    margin: 10px 10px;
    margin-left: auto;
    margin-right: auto;
    padding: 0px;
    width: 200px;
    height: 50px;
    font-size: 24pt;
    font-weight: bold;
    color: black;
    border-radius: 10px !important;
  }
  
  button#button {
    height: 250px !important;
    background: #808080 url('door-static.png') no-repeat center bottom;
    border-radius: 10px !important;
    cursor: pointer !important;
  }

  #sensor1 {
    width: 300px;
    height: 60px;
  }
    
  #gpio18.LOW {
    color: #FFFFFF !important;
  }
  
  #gpio18.HIGH {
    background-color: #00bfff;
    color: #FFFFFF !important;
  }
  
  #confirmText {
    margin-left: auto;
    margin-right: auto;
    padding: 0px;
    margin-top: 0px;
    visibility: hidden;
    width: 300px;
  }
  
  #confirmBox {
    height: 60px;
    width: 200px;
    margin-left: auto;
    margin-right: auto;
    position:relative;
    visibility: hidden;
  }
  
  #yes {
    background-color: green;
    float: left;
  }
  
  #no {
    background-color: red;
    float: right;
  }
  
  .confirmButton {
    border: 3px solid #000000;
    border-radius: 10px;
    cursor: pointer;
    height: 50px;
    width: 75px;
    font-size: 24pt;
    font-weight: bold;
    text-align: center;
    line-height: 50px;
  }
 </style>
 
</head>
<body>
<div id="header"><h2> PENNY </h2>
  </div>
  
<div id="sensor1" style="margin-left: auto; margin-right: auto; position:relative">
  </div>
  
<!-- This line builds the main button -->
<div id="content" style="margin-left: auto; margin-right: auto; position:relative">
  </div>
  
<!-- These two lines build the confirmation box/div -->
<div id="confirmText"><h2>Are you sure?</h2>
  </div>
<div id="confirmBox">
    <div id="yes" class="confirmButton">YES</div>
    <div id="no" class="confirmButton">NO</div>
  </div>
</body>
</html>